stormData <- read.csv("repdata-data-StormData.csv.bz2")
setwd("~/GitHub/Reproducible_2")
stormData <- read.csv("repdata-data-StormData.csv.bz2")
dim(stormData)
stormData <- read.csv("repdata-data-StormData.csv.bz2", stringsAsFactors = FALSE)
stormData <- read.csv("repdata-data-StormData.csv.bz2", quote = "", stringsAsFactors = FALSE)
table(stormData$X.EVTYPE.)
table(stormData$X.PROPDMGEXP.)
head(stormData)
tail(stormData)
table(stormData$X.EVTYPE.)[order(table(stormData$X.EVTYPE.))]
table(stormData$X.EVTYPE.)[order(rownames(table(stormData$X.EVTYPE.)))]
eventTypes <- rownames(table(stormData$X.EVTYPE.)[order(rownames(table(stormData$X.EVTYPE.)))])
eventTypes[1:50]
eventTypes[51:150]
eventTypes <- rownames(table(stormData$X.EVTYPE.)[-order(table(stormData$X.EVTYPE.))])
eventTypes[1:150]
eventTypes <- table(stormData$X.EVTYPE.)[-order(table(stormData$X.EVTYPE.))]
eventTypes <- table(stormData$X.EVTYPE.)
eventOrder <- -order(eventTypes)
eventOrder <- order(eventTypes)
eventOrder <- order(-eventTypes)
eventTypes[eventOrder][1:10]
eventTypes[eventOrder][1:100]
stormData[902288:902300,]
sum(stormData$X.FATALITIES.[902288:1773320,])
sum(stormData$X.FATALITIES.[902288:1773320])
sum(as.numeric(stormData$X.FATALITIES.[902288:1773320]))
sum(as.numeric(stormData$X.FATALITIES.[902288:1773320]), na.rm = T)
sum(stormData$X.FATALITIES.[902288:1773320] == "")
sum(stormData$X.FATALITIES.[902288:1773320] == "0")
sum(stormData$X.FATALITIES.[902288:1773320] == "1")
sum(stormData$X.FATALITIES.[902288:1773320] >= "1")
1173320 - 902287
table(stormData$X.FATALITIES.)
table(stormData$X.INJURIES.)
sum(table(stormData$X.INJURIES.))
max(table(stormData$X.INJURIES.))
which(table(stormData$X.INJURIES.) == max(table(stormData$X.INJURIES.)))
str(stormData$X.INJURIES.)
intInjuries <- as.integer(stormData$X.INJURIES.)
intInjuries[is.na(intInjuries)] <- 0
table(intInjuries)
hist(intInjuries)
max(intInjuries)
which(intInjuries == max(intInjuries))
stormData[1767126,]
stormData <- read.csv("repdata-data-StormData.csv.bz2", stringsAsFactors = FALSE)
dim(stormData)
attach(stormData)
summary(stormData)
stormData[which(INJURIES == max(INJURIES))]
stormData[which(INJURIES == max(INJURIES)),]
?percentile
?quantile
quantile(1:10, .9)
stormData[which(INJURIES > quantile(INJURIES,.99)),]
stormData[which(INJURIES > quantile(INJURIES,.999)),]
stormData[which(INJURIES > quantile(INJURIES,.99999)),]
casualties <- read.csv("cas.csv")
setwd("~/GitHub/Reproducible_2")
casualties <- read.csv("cas.csv")
setwd("~/GitHub/Reproducible_2")
stormData <- read.csv("repdata-data-StormData.csv.bz2", stringsAsFactors = FALSE)
dim(stormData)
setwd("~/GitHub/Reproducible_2")
stormData <- read.csv("repdata-data-StormData.csv.bz2", stringsAsFactors = FALSE)
dim(stormData)
setwd("~/GitHub/Reproducible_1")
activity <- read.csv("activity.csv")
setwd("~/GitHub/Reproducible_2")
dim(stormData)
damages <- stormData[stormData$PROPDMG > 0 | stormData$CROPDMG > 0,]
casualties <- stormData[stormData$FATALITIES > 1 | stormData$INJURIES > 1,  ]
casualties$CAT <- casualties$EVTYPE
casualties$CAT[grepl("TORNAD",casualties$CAT, ignore.case = T) ] <- "TORNADO"
casualties$CAT[grepl("TSTM",casualties$CAT, ignore.case = T)  ] <- "THUNDER"
casualties$CAT[grepl("THUNDER",casualties$CAT, ignore.case = T)  ] <- "THUNDER"
casualties$CAT[grepl("FLOOD",casualties$CAT, ignore.case = T)  ] <- "FLOOD"
casualties$CAT[grepl("HEAT",casualties$CAT, ignore.case = T)  ] <- "HEAT"
casualties$CAT[grepl("WIND",casualties$CAT, ignore.case = T)  ] <- "WIND"
casualties$CAT[grepl("WINTER",casualties$CAT, ignore.case = T)  ] <- "SNOW"
casualties$CAT[grepl("BLIZZARD",casualties$CAT, ignore.case = T)  ] <- "SNOW"
casualties$CAT[grepl("FIRE",casualties$CAT, ignore.case = T)  ] <- "FIRE"
casualties$CAT[grepl("TIDE",casualties$CAT, ignore.case = T)  ] <- "TIDE"
casualties$CAT[grepl("CURRENT",casualties$CAT, ignore.case = T)  ] <- "TIDE"
casualties$CAT[grepl("RAIN",casualties$CAT, ignore.case = T)  ] <- "RAIN"
casualties$CAT[grepl("FOG",casualties$CAT, ignore.case = T)  ] <- "FOG"
casualties$CAT[grepl("HEAT",casualties$CAT, ignore.case = T)  ] <- "HEAT"
casualties$CAT[grepl("COLD",casualties$CAT, ignore.case = T)  ] <- "COLD"
casualties$CAT[grepl("SNOW",casualties$CAT, ignore.case = T)  ] <- "SNOW/ICE"
casualties$CAT[grepl("ICE",casualties$CAT, ignore.case = T)  ] <- "SNOW/ICE"
casualties$CAT[grepl("ICY",casualties$CAT, ignore.case = T)  ] <- "SNOW/ICE"
casualties$CAT[grepl("SURF",casualties$CAT, ignore.case = T)  ] <- "TIDE"
casualties$CAT[grepl("TROP",casualties$CAT, ignore.case = T)  ] <- "TROPICAL_STORM"
casualties$CAT[grepl("HURRIC",casualties$CAT, ignore.case = T)  ] <- "TROPICAL_STORM"
casualties$CAT[grepl("TYPHOON",casualties$CAT, ignore.case = T)  ] <- "TROPICAL_STORM"
casualties$CAT[grepl("TYPHOON",casualties$CAT, ignore.case = T)  ] <- "TROPICAL_STORM"
casualties$CAT[grepl("DUST",casualties$CAT, ignore.case = T)  ] <- "DUST"
table(casualties$CAT)[order(-table(casualties$CAT))]
fatalities <- tapply(casualties$FATALITIES,casualties$CAT,sum)
injuries <- tapply(casualties$FATALITIES,casualties$CAT,sum)
unhealthy <- table(casualties$CAT)[order(-table(casualties$CAT))]
max(fatalities)
max(injuries)
injuries <- tapply(casualties$INJURIES,casualties$CAT,sum)
max(injuries)
library("ggplot2", lib.loc="C:/Users/Anichini/Documents/R/win-library/3.0")
require(ggplot2)
unhealthy <- table(casualties$CAT)
fatalities <- tapply(casualties$FATALITIES,casualties$CAT,sum)
injuries <- tapply(casualties$INJURIES,casualties$CAT,sum)
rownames(unhealthy)
unhealthy[1:5]
fatalities[1:5]
injuries[1:5]
danger <- cbind(rownames(unhealthy), fatalities, injuries, unhealthy)
colnames(danger) <- c("Category", "Fatalities", "Injuries", "Events")
max(unhealthy)
max(fatalities)
summary(danger)
str(danger)
max(danger$Fatalities)
danger <- data.frame(cbind(rownames(unhealthy), fatalities, injuries, unhealthy))
colnames(danger) <- c("Category", "Fatalities", "Injuries", "Events")
max(danger$Fatalities)
head(danger)
danger <- data.frame(cbind(fatalities, injuries, unhealthy))
colnames(danger) <- c("Fatalities", "Injuries", "Events")
head(danger)
summary(danger)
ggplot(danger, aes(x=Injuries, y=Fatalities, size=Events, label=Category),guide=FALSE)+
geom_point(colour="white", fill="red", shape=21)+ scale_area(range=c(1,25))+
scale_x_continuous(name="Total Injuries", limits=c(0,90000))+
scale_y_continuous(name="Total Fatalities", limits=c(0,5500))+
geom_text(size=4)+
theme_bw()
danger$Category <- rownames(danger)
ggplot(danger, aes(x = Injuries, y = Fatalities, size = Events,
label = Category, guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_continuous(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
ggplot(danger, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_continuous(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
ggplot(danger, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_log(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_log(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
ggplot(danger, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_log10(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_log10(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
danger2 <- danger[danger$Fatalities > 0 & danger$Injuries > 0,]
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_log10(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_log10(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
danger2 <- danger[danger$Fatalities >= 10 & danger$Injuries >= 10,]
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_log10(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_log10(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
summary(danger2)
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(name = "Total Injuries", limits = c(0, 90000)) +
scale_y_continuous(name = "Total Fatalities", limits = c(0, 5500)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_log(name = "Total Injuries (log 10 scale)", limits = c(0, 5)) +
scale_y_continuous(name = "Total Fatalities (log 10 scale)", limits = c(0, 4)) +
geom_text(size = 4) + theme_bw()
log(6000)
log(90000)
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log 10 scale)", limits = c(0, 12)) +
scale_y_continuous(trans = "log", name = "Total Fatalities (log 10 scale)", limits = c(0, 9)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(name = "Total Injuries (log 10 scale)", limits = c(0, 12)) +
scale_y_continuous(name = "Total Fatalities (log 10 scale)", limits = c(0, 9)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(name = "Total Injuries (log 10 scale)", limits = c(0, 90000)) +
scale_y_continuous(name = "Total Fatalities (log 10 scale)", limits = c(0, 6000)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log 10 scale)", limits = c(0, 90000)) +
scale_y_continuous(name = "Total Fatalities (log 10 scale)", limits = c(0, 6000)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log 10 scale)", limits = c(1, 90000)) +
scale_y_continuous(name = "Total Fatalities (log 10 scale)", limits = c(0, 6000)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log scale)", limits = c(1, 90000)) +
scale_y_continuous(trans = "log", name = "Total Fatalities (log scale)", limits = c(0, 6000)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log scale)", limits = c(1, 90000)) +
scale_y_continuous(trans = "log", name = "Total Fatalities (log scale)", limits = c(1, 6000)) +
geom_text(size = 4) + theme_bw()
ggplot(danger2, aes(x = Injuries, y = Fatalities, size = Events,
label = Category), guide = FALSE) +
geom_point(colour = "white", fill = "red", shape = 21)+
scale_area(range = c(1,25)) +
scale_x_continuous(trans = "log", name = "Total Injuries (log scale)", limits = c(1, 12)) +
scale_y_continuous(trans = "log", name = "Total Fatalities (log scale)", limits = c(1, 9)) +
geom_text(size = 4) + theme_bw()
